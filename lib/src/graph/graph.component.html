<div class="graph" [style.width]="width" [style.height]="height">
  <svg:svg class="graph-container" [attr.viewBox]="stringifiedViewBox$ | async" #graphContainer>
    <defs class="defs">
      <ng-container *ngIf="defsTemplate" [ngTemplateOutlet]="defsTemplate.template"></ng-container>
    </defs>

    <ng-content></ng-content>

    <svg:g class="nodes-container" #nodesContainer>
      <svg:g
        *ngFor="let node of transformedNodes; trackBy: trackById"
        class="node"
        [id]="node.id"
        [class.is-visible]="node.isVisible"
        [attr.transform]="node.transform"
        #node
      >
        <ng-container
          [ngTemplateOutlet]="nodeTemplate.template"
          [ngTemplateOutletContext]="{ $implicit: node }"
        ></ng-container>
      </svg:g>
    </svg:g>

    <svg:g class="edges-container">
      <svg:g
        *ngFor="let edge of transformedEdges; trackBy: trackById"
        class="edge"
        [id]="edge.id"
        #edge
      >
        <ng-container
          [ngTemplateOutlet]="edgeTemplate.template"
          [ngTemplateOutletContext]="{ $implicit: edge }"
        ></ng-container>
      </svg:g>
    </svg:g>
  </svg:svg>
</div>
